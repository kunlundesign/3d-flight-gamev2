<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎮 Flight Combat Game - Debug Version</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: #000;
            font-family: 'Arial', sans-serif;
        }
        
        #container {
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        
        #debug {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0,0,0,0.9);
            color: white;
            padding: 15px;
            border-radius: 8px;
            z-index: 1000;
            font-size: 14px;
            border: 2px solid #00ff00;
            max-width: 300px;
        }
        
        #status {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: rgba(0,0,0,0.9);
            color: lime;
            padding: 10px;
            border-radius: 5px;
            z-index: 1000;
            font-family: monospace;
            border: 1px solid lime;
        }
        
        .error {
            color: red !important;
            border-color: red !important;
        }
        
        .success {
            color: lime !important;
            border-color: lime !important;
        }
    </style>
</head>
<body>
    <div id="container"></div>
    
    <div id="debug">
        <h3>🎮 Flight Combat Game Debug</h3>
        <p><strong>🎯 武器控制:</strong></p>
        <p>🔫 Left Click: 机翼机枪</p>
        <p>💣 Spacebar: 投掷炸弹</p>
        <p><strong>✈️ 飞行控制:</strong></p>
        <p>⌨️ WASD: 俯仰偏航</p>
        <p>🖱️ 鼠标: 视角控制</p>
        <p>⚡ Shift/Ctrl: 油门</p>
        <hr>
        <p><strong>🎯 瞄准系统:</strong></p>
        <p>🔴 红色圆圈: 机枪准星</p>
        <p>🟠 橙色圆圈: 投弹瞄准</p>
    </div>
    
    <div id="status">
        🚀 Initializing...
    </div>

    <script type="module">
        const statusEl = document.getElementById('status');
        let scene, lastTime = 0;
        
        function updateStatus(message, isError = false) {
            statusEl.textContent = message;
            statusEl.className = isError ? 'error' : 'success';
            console.log(message);
        }
        
        async function initGame() {
            try {
                updateStatus('📦 Loading Three.js...');
                const THREE = await import('/node_modules/three/build/three.module.js');
                updateStatus(`✅ Three.js ${THREE.REVISION} loaded`);
                
                updateStatus('🎮 Loading game scene...');
                const { PlayScene } = await import('./src/game/PlayScene.js');
                
                updateStatus('🏗️ Initializing scene...');
                scene = new PlayScene();
                await scene.init();
                
                updateStatus('🎯 Game ready! Click screen to start!');
                
                // 开始游戏循环
                function animate(time) {
                    const deltaTime = (time - lastTime) * 0.001;
                    lastTime = time;
                    
                    if (scene) {
                        scene.update(deltaTime);
                        scene.render();
                    }
                    
                    requestAnimationFrame(animate);
                }
                
                animate(0);
                
                // 添加额外的调试信息
                setTimeout(() => {
                    updateStatus('🎮 Game running! Look for crosshairs!');
                }, 2000);
                
            } catch (error) {
                console.error('❌ Game initialization failed:', error);
                updateStatus(`❌ Error: ${error.message}`, true);
                
                // 显示详细错误
                const debugEl = document.getElementById('debug');
                debugEl.innerHTML += `
                    <hr>
                    <h4 style="color: red;">❌ Error Details:</h4>
                    <p style="color: red; font-size: 12px;">${error.message}</p>
                    <p style="color: orange; font-size: 11px;">Check browser console for more info</p>
                `;
            }
        }
        
        // 等待页面加载
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initGame);
        } else {
            initGame();
        }
    </script>
</body>
</html>
